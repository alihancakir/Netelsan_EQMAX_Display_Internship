#include <stdbool.h>
#include <stdint.h>
#include <unistd.h>
#include <stdio.h>

//#include "disp_driver.h"
#include "system.h"
#include "font_ram.h"
#include "register.h"
#include "i2c.h"

//Font ram user field
#define QR1_1			0x01C0
#define QR1_2			0x01C1
#define QR1_3			0x01C2
#define QR1_4			0x01C3

#define QR2_1			0x01C4
#define QR2_2			0x01C5
#define QR2_3	  		0x01C6
#define QR2_4			0x01C7

#define QR3_1	   		0x01C8
#define QR3_2	    	0x01C9
#define QR3_3  			0x01CA
#define QR3_4	 		0x01CB

//QR bitmap bytes
uint8_t QR1_1_BM[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1F, 0xF0, 0x1F, 0xF0, 0x18, 
0x00, 0x1B, 0xF0, 0x1B, 0xF0, 0x1B, 0xF0, 0x1B, 0xF0, 0x1B,	0xF0, 
0x1B, 0xF0, 0x18, 0x00, 0x1F, 0xF0, 0x1F, 0xF0, 0x00, 0x00
};
uint8_t QR1_2_BM[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xE3, 0x30, 0xE3, 0x30, 0x60, 
0x00, 0x6F, 0x10, 0x6F, 0x10, 0x6C, 0xE0, 0x6C, 0xE0, 0x6C, 
0x60, 0x6C, 0x60, 0x6C, 0x00, 0xEC, 0xD0, 0xEC, 0xD0, 0x0C, 0xC0
};
uint8_t QR1_3_BM[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x70, 0x03, 0x70, 0x6C, 
0x60, 0xEF, 0x60, 0x93, 0x60, 0x70, 0x60, 0x70, 0x60, 0x60, 0x60, 
0x7C, 0x60, 0x7C, 0x60, 0xB3, 0x70, 0xB3, 0x70, 0x33, 0x00
};
uint8_t QR1_4_BM[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0x80, 0xFF, 0x80, 0x01, 
0x80, 0xFD, 0x80, 0xFD, 0x80, 0xFD, 0x80, 0xFD, 0x80, 0xFD, 0x80, 
0xFD, 0x80, 0x01, 0x80, 0xFF, 0x80, 0xFF, 0x80, 0x00, 0x00
};
//---------------------------------------------
uint8_t QR2_1_BM[] = {
0x1B, 0xF0, 0x1B, 0xF0, 0x1B, 0xC0, 0x1B, 0xC0, 0x1E, 0x30, 0x1E, 
0x30, 0x01, 0xF0, 0x19, 0x00, 0x19, 0x00, 0x1E, 0x10, 0x1E, 0xF0, 
0x18, 0xF0, 0x1B, 0xF0, 0x1B, 0xF0, 0x1B, 0x30, 0x1B, 0x30
};
uint8_t QR2_2_BM[] = {
0xEC, 0xC0, 0xE3, 0xE0, 0x9F, 0xF0, 0x9C, 0xF0, 0x78, 0x70, 0x78, 
0x70, 0x9F, 0xF0, 0x7C, 0xC0, 0x7C, 0xC0, 0x8F, 0x10, 0x83, 0x10, 
0xF3, 0x00, 0xFF, 0x90, 0x0F, 0x90, 0x63, 0x90, 0x6F, 0x90
};
uint8_t QR2_3_BM[] = {
0x33, 0x70, 0x70, 0x70, 0xE3, 0x10, 0xE3, 0x10, 0x9F, 0xE0, 0x9D, 
0xE0, 0x9D, 0xF0, 0x6D, 0xE0, 0x6D, 0xE0, 0xE3, 0xD0, 0xFF, 0xD0, 
0x7F, 0xF0, 0x80, 0x30, 0x80, 0x30, 0xFF, 0xF0, 0xFF, 0xF0
};
uint8_t QR2_4_BM[] = {
0xF8, 0x00, 0xF8, 0x00, 0x06, 0x00, 0x86, 0x00, 0x77, 0x80, 0x71, 
0x80, 0xE1, 0x80, 0x6F, 0x80, 0x6F, 0x80, 0xB6, 0x00, 0xB7, 0x80, 
0xF7, 0x80, 0xC1, 0x80, 0xC1, 0x80, 0xCC, 0x00, 0xCC, 0x00
};
//-----------------------------------------------------
uint8_t QR3_1_BM[] = {
0x00, 0x00, 0x1F, 0xF0, 0x1F, 0xF0, 0x18, 0x00, 0x1B, 0xF0, 0x1B, 
0xF0, 0x1B, 0xF0, 0x1B, 0xF0, 0x1B, 0xF0, 0x1B, 0xF0, 0x18, 0x00, 
0x1F, 0xF0, 0x1F, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
uint8_t QR3_2_BM[] = {
0x0F, 0x00, 0xE3, 0x70, 0xE3, 0x70, 0x6C, 0x60, 0x6C, 0x70, 0x6C, 
0x70, 0x6C, 0x10, 0x6C, 0xD0, 0x6C, 0xC0, 0x6C, 0xF0, 0x60, 0xF0, 
0xEC, 0x70, 0xEC, 0x70, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
uint8_t QR3_3_BM[] = {
0x37, 0x00, 0xB7, 0x60, 0xB7, 0x60, 0x07, 0x00, 0xFF, 0xF0, 0xFF, 
0xF0, 0xBD, 0xE0, 0xBD, 0xE0, 0x42, 0x00, 0x4E, 0x00, 0x0F, 0xF0, 
0xE1, 0xF0, 0xE1, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
uint8_t QR3_4_BM[] = {
0xF0, 0x00, 0xCF, 0x80, 0xCF, 0x80, 0xF1, 0x80, 0xFD, 0x80, 0xCC, 
0x00, 0xCF, 0x80, 0xFF, 0x80, 0x3D, 0x80, 0x3D, 0x80, 0xF1, 0x80, 
0xFF, 0x80, 0xFF, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
void show_custom_font_ram_block1(unsigned char position, uint16_t font){
	
	write_byte(OSD_GROUP_ADDR, 0x32, 0x0F);  // coef
	
	write_byte(OSD_GROUP_ADDR, 0x2B, 0xFF);  // vertical
	write_byte(OSD_GROUP_ADDR, 0x2C, 0xFF);  // vertical
	write_byte(OSD_GROUP_ADDR, 0x2D, 0xFF);  // vertical
	write_byte(OSD_GROUP_ADDR, 0x2E, 0xFF);  // vertical
	
	write_byte(OSD_GROUP_ADDR, 0x2F, 0xFF);  // horizontal
	write_byte(OSD_GROUP_ADDR, 0x30, 0xFF);  // horizontal
	write_byte(OSD_GROUP_ADDR, 0x31, 0xFF);  // horizontal

	
	write_byte(OSD_GROUP_ADDR, CHAR_X_SIZE,     0x0C);//x
	write_byte(OSD_GROUP_ADDR, CHAR_Y_SIZE,     0x10);//y
	write_byte(OSD_GROUP_ADDR, BLOCK1_START_ADDR, 0x00);
    write_byte(OSD_GROUP_ADDR, INDEX_RAM_ADD_L, position);
    write_byte(OSD_GROUP_ADDR, INDEX_RAM_DATA_H,(font>>8));
    write_byte(OSD_GROUP_ADDR, INDEX_RAM_DATA_L, font);
}


void show_qr(bool state){
	if(state==1){
		show_qr_block0(1);		//QR block open
		
		//QR bitmap send and show
		load_custom_font_ram(0, QR1_1_BM);
		show_custom_font_ram(0,QR1_1);
		
		load_custom_font_ram(1, QR1_2_BM);
		show_custom_font_ram(1,QR1_2);
		
		load_custom_font_ram(2, QR1_3_BM);
		show_custom_font_ram(2,QR1_3);
		
		load_custom_font_ram(3, QR1_4_BM);
		show_custom_font_ram(3,QR1_4);
		//------------------------------------
		load_custom_font_ram(4, QR2_1_BM);
		show_custom_font_ram(4,QR2_1);
		
		load_custom_font_ram(5, QR2_2_BM);
		show_custom_font_ram(5,QR2_2);
		
		load_custom_font_ram(6, QR2_3_BM);
		show_custom_font_ram(6,QR2_3);
		
		load_custom_font_ram(7, QR2_4_BM);
		show_custom_font_ram(7,QR2_4);
		//-----------------------------------
		load_custom_font_ram(8, QR3_1_BM);
		show_custom_font_ram(8,QR3_1);
		
		load_custom_font_ram(9, QR3_2_BM);
		show_custom_font_ram(9,QR3_2);
		
		load_custom_font_ram(10, QR3_3_BM);
		show_custom_font_ram(10,QR3_3);
		
		load_custom_font_ram(11, QR3_4_BM);
		show_custom_font_ram(11,QR3_4);
		
	}
	/*else{
		show_qr_block0(0);		//QR block close
	}*/
}



















